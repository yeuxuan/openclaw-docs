# 11 如何照着做一个类似项目

## 最小可行版本（MVP）建议

1. 先做 4 层
- CLI 层（命令输入）
- Gateway 层（长连接 + 控制方法）
- Routing 层（agent/session）
- Auto-reply 层（模型调用 + 回复）

2. 第二阶段再加
- 插件系统（先支持 tool + channel 两种注册）
- 配置热重载
- 会话缓存与清理策略

3. 第三阶段再加
- 多模型回退
- 多账号通道
- 媒体管线与安全策略

## 建议目录骨架（可直接借鉴）

```text
src/
  cli/
  gateway/
  routing/
  channels/
  auto-reply/
  agents/
  plugins/
  config/
  media/
  infra/
```

## 开发顺序（最稳）

1. 跑通单通道文本收发
2. 接入 session store
3. 接入模型调用
4. 加入路由规则
5. 再做插件化

## 常见坑（OpenClaw 已经规避）

- 一上来就把全部命令全量加载，启动慢
- 没有 session key 设计，导致并发串线
- 没有热重载边界，配置变更必须重启
- 媒体没有 TTL 和安全校验，留下风险
- 插件注册无冲突检测，线上互相覆盖

## 结束语

如果你后续要我继续做下一步，我建议是:  
基于这套文档，再给你生成一个“简化版 OpenClaw 骨架仓库设计稿”（模块、接口、关键类型、最小代码模板）。

